var Media = (function () {
    function Media() {
    }
    Media.prototype.play = function (media) {
        var player = this._getPlayer(media);
        var sources = media.getElementsByClassName('c-media__source');
        this._start(player, sources[0]);
    };
    Media.prototype.pause = function (media) {
        var player = this._getPlayer(media);
        var source = this._getCurrent(player);
        player.pause();
        player.classList.remove('is-playing');
        player.classList.add('is-paused');
        source.classList.remove('is-current');
        source.classList.add('is-waiting');
    };
    Media.prototype.first = function (media) {
        var player = this._getPlayer(media);
        var current = this._getCurrent(player);
        var next = this._getFirst(player);
        player.src = next.src;
        player.play();
        current.classList.remove('is-current');
        current.classList.add('is-queueing');
        next.classList.remove('is-played');
        next.classList.add('is-current');
    };
    Media.prototype.backwards = function (media) {
        var player = this._getPlayer(media);
        var current = this._getCurrent(player);
        var next = this._getPrevious(player);
        player.src = next.src;
        player.play();
        current.classList.remove('is-current');
        current.classList.add('is-queueing');
        next.classList.remove('is-played');
        next.classList.add('is-current');
    };
    Media.prototype.forward = function (media) {
        var player = this._getPlayer(media);
        var current = this._getCurrent(player);
        var next = this._getNext(player);
        player.src = next.src;
        player.play();
        current.classList.remove('is-current');
        current.classList.add('is-played');
        next.classList.remove('is-queueing');
        next.classList.add('is-current');
    };
    Media.prototype.last = function (media) {
        var player = this._getPlayer(media);
        var current = this._getCurrent(player);
        var next = this._getLast(player);
        player.src = next.src;
        player.play();
        current.classList.remove('is-current');
        current.classList.add('is-played');
        next.classList.remove('is-queueing');
        next.classList.add('is-current');
    };
    Media.prototype._getPlayer = function (media) {
        return media.getElementsByClassName('c-media__player')[0];
    };
    Media.prototype._getCurrent = function (player) {
        return player.querySelector('.c-media__source.is-current');
    };
    Media.prototype._getWaiting = function (player) {
        return player.querySelector('.c-media__source.is-waiting');
    };
    Media.prototype._getFirst = function (player) {
        var sources = player.querySelectorAll('.c-media__source.is-played');
        for (var i = 1; i < sources.length; i++) {
            sources[i].classList.remove('is-played');
            sources[i].classList.add('is-queueing');
        }
        return sources[0];
    };
    Media.prototype._getPrevious = function (player) {
        var sources = player.querySelectorAll('.c-media__source.is-played');
        return sources[sources.length - 1];
    };
    Media.prototype._getNext = function (player) {
        return player.querySelectorAll('.c-media__source.is-queueing')[0];
    };
    Media.prototype._getLast = function (player) {
        var sources = player.querySelectorAll('.c-media__source.is-queueing');
        for (var i = 0; i < (sources.length - 1); i++) {
            sources[i].classList.remove('is-queueing');
            sources[i].classList.add('is-played');
        }
        return sources[sources.length - 1];
    };
    Media.prototype._start = function (player, source) {
        var traveled = player.parentNode.getElementsByClassName('c-media__traveled')[0];
        var duration = player.parentNode.getElementsByClassName('c-media__duration')[0];
        var current = player.parentNode.getElementsByClassName('c-media__current')[0];
        if (this._isPaused(player)) {
            var source_1 = this._getWaiting(player);
            player.play();
            player.classList.remove('is-paused');
            player.classList.add('is-playing');
            source_1.classList.remove('is-waiting');
            source_1.classList.add('is-current');
        }
        else {
            player.src = source.src;
            player.play();
            player.classList.remove('is-stoped');
            player.classList.add('is-playing');
            source.classList.remove('is-queueing');
            source.classList.add('is-current');
        }
        setInterval(function () {
            traveled.textContent = (player.currentTime / 60).toFixed(2);
            duration.textContent = (player.duration / 60).toFixed(2);
            current.style.width = player.currentTime + '%';
        }, 1000);
    };
    Media.prototype._isPaused = function (player) {
        return player.classList.contains('is-paused');
    };
    return Media;
}());
var MediaController = (function () {
    function MediaController() {
        this._media = new Media();
    }
    MediaController.prototype.play = function (media) {
        this._media.play(media);
    };
    MediaController.prototype.pause = function (media) {
        this._media.pause(media);
    };
    MediaController.prototype.first = function (media) {
        this._media.first(media);
    };
    MediaController.prototype.backwards = function (media) {
        this._media.backwards(media);
    };
    MediaController.prototype.forward = function (media) {
        this._media.forward(media);
    };
    MediaController.prototype.last = function (media) {
        this._media.last(media);
    };
    return MediaController;
}());
var ObjectHelper = (function () {
    function ObjectHelper() {
    }
    ObjectHelper.show = function (obj) {
        obj.classList.add('is-show');
        obj.classList.remove('is-hide');
        obj.setAttribute('aria-hidden', 'false');
        obj.setAttribute('aria-expanded', 'true');
    };
    ObjectHelper.hide = function (obj) {
        obj.classList.add('is-hide');
        obj.classList.remove('is-show');
        obj.setAttribute('aria-hidden', 'true');
        obj.setAttribute('aria-expanded', 'false');
    };
    ObjectHelper.isHide = function (obj) {
        return obj.classList.contains('is-hide');
    };
    return ObjectHelper;
}());
var Nav = (function () {
    function Nav() {
    }
    Nav.prototype.toggle = function (obj) {
        var target = obj.parentNode.querySelector('ul') || obj.parentNode.querySelector('menu');
        if (ObjectHelper.isHide(target))
            ObjectHelper.show(target);
        else
            ObjectHelper.hide(target);
    };
    return Nav;
}());
var NavController = (function () {
    function NavController() {
        this._nav = new Nav();
    }
    NavController.prototype.dropdown = function (link, event) {
        event.preventDefault();
        this._nav.toggle(link);
    };
    return NavController;
}());
var Tab = (function () {
    function Tab() {
    }
    Tab.prototype.toggle = function (obj) {
        if (!obj.classList.contains('is-active')) {
            this._isActiveTab(obj);
            this._showBody(obj);
        }
    };
    Tab.prototype._isActiveTab = function (obj) {
        this._isInactiveTab(obj.parentNode.parentNode.querySelector('.is-active'));
        obj.setAttribute('aria-selected', 'true');
        obj.classList.add('is-active');
    };
    Tab.prototype._isInactiveTab = function (obj) {
        obj.setAttribute('aria-selected', 'false');
        obj.classList.remove('is-active');
    };
    Tab.prototype._showBody = function (obj) {
        var body = this._findBody(obj);
        ObjectHelper.hide(body.parentNode.querySelector('.is-show'));
        ObjectHelper.show(body);
    };
    Tab.prototype._findBody = function (obj) {
        return obj.parentNode.parentNode.parentNode.querySelector(obj.getAttribute('href'));
    };
    return Tab;
}());
var TabController = (function () {
    function TabController() {
        this._tab = new Tab();
    }
    TabController.prototype.toggle = function (tab, event) {
        event.preventDefault();
        this._tab.toggle(tab);
    };
    return TabController;
}());
var ModalBackground = (function () {
    function ModalBackground(id) {
        this._id = id;
    }
    ModalBackground.prototype.create = function () {
        var modalBackground = document.createElement('DIV');
        modalBackground.classList.add('o-modal__background');
        modalBackground.setAttribute('data-modal', this._id);
        modalBackground.setAttribute('onclick', "ModalController.hide('" + this._id + "')");
        return modalBackground;
    };
    ModalBackground.prototype.remove = function (id) {
        var modalBackground;
        if (this._isFrame())
            modalBackground = parent.document.querySelector("[data-modal=" + id + "]");
        else
            modalBackground = document.querySelector("[data-modal=" + id + "]");
        if (modalBackground != null && modalBackground != undefined)
            modalBackground.parentNode.removeChild(modalBackground);
    };
    ModalBackground.prototype._isFrame = function () {
        return parent.document.location != self.location;
    };
    return ModalBackground;
}());
var ModalContent = (function () {
    function ModalContent() {
    }
    ModalContent.prototype.create = function () {
        var content = document.createElement('DIV');
        content.classList.add('o-modal__content');
        return content;
    };
    return ModalContent;
}());
var Modal = (function () {
    function Modal() {
        this._modalBackground = new ModalBackground();
    }
    Modal.prototype.append = function () {
        var modal = this.create();
        modal.appendChild(new ModalContent().create());
        document.body.appendChild(modal);
    };
    Modal.prototype.hide = function (id) {
        var modal;
        this._removeBackground(id);
        if (this._isFrame())
            modal = parent.document.getElementById(id);
        else
            modal = document.getElementById(id);
        ObjectHelper.hide(modal);
    };
    Modal.prototype.show = function (id) {
        this._insertBackground(id);
        var modal = document.getElementById(id);
        ObjectHelper.show(modal);
    };
    Modal.prototype.create = function () {
        var modal = document.createElement('DIALOG');
        modal.classList.add('o-modal', 'o-modal--large', 'is-hide');
        modal.id = 'o-modal--1';
        modal.setAttribute('aria-hidden', 'true');
        modal.setAttribute('aria-expanded', 'false');
        modal.setAttribute('aria-labelledby', 'o-modal__title--1');
        modal.setAttribute('role', 'dialog');
        return modal;
    };
    Modal.prototype._insertBackground = function (id) {
        document.body.appendChild(new ModalBackground(id).create());
    };
    Modal.prototype._removeBackground = function (id) {
        this._modalBackground.remove(id);
    };
    Modal.prototype._isFrame = function () {
        return parent.document.location != self.location;
    };
    return Modal;
}());
var ModalController = (function () {
    function ModalController() {
        this._modal = new Modal();
    }
    ModalController.prototype.hide = function (id) {
        this._modal.hide(id);
        return this;
    };
    ModalController.prototype.show = function (id) {
        this._idModal = id;
        this._modal.show(id);
        return this;
    };
    return ModalController;
}());
var Options = (function () {
    function Options() {
    }
    Options.prototype.toggle = function (options) {
        var ul = options.querySelector('ul');
        if (ObjectHelper.isHide(ul))
            ObjectHelper.show(ul);
        else
            ObjectHelper.hide(ul);
    };
    return Options;
}());
var OptionsController = (function () {
    function OptionsController() {
        this._options = new Options();
    }
    OptionsController.prototype.toggle = function (options, event) {
        event.preventDefault();
        this._options.toggle(options);
    };
    return OptionsController;
}());
var Steps = (function () {
    function Steps() {
    }
    Steps.prototype.step = function (target, current) {
        ObjectHelper.show(this._findStep(target));
        ObjectHelper.hide(this._findStep(current));
    };
    Steps.prototype._findStep = function (s) {
        return document.getElementsByClassName(s)[0];
    };
    return Steps;
}());
var StepsController = (function () {
    function StepsController() {
        this._steps = new Steps();
    }
    StepsController.prototype.step = function (step) {
        this._steps.step(step.dataset.target, step.dataset.current);
    };
    return StepsController;
}());
(function (w) {
    window['MediaController'] = new MediaController();
    window['ModalController'] = new ModalController();
    window['NavController'] = new NavController();
    window['OptionsController'] = new OptionsController();
    window['StepsController'] = new StepsController();
    window['TabController'] = new TabController();
})(window);
var StringHelper = (function () {
    function StringHelper() {
    }
    StringHelper.trimAll = function (string) {
        return string.replace(/\s/g, "");
    };
    StringHelper.trimLeft = function (string) {
        return string.replace(/^\s+/, "");
    };
    StringHelper.trimLeftRight = function (string) {
        return string.replace(/^\s+|\s+$/g, "");
    };
    StringHelper.trimRight = function (string) {
        return string.replace(/\s+$/, "");
    };
    return StringHelper;
}());
var ModalFrame = (function () {
    function ModalFrame(url) {
        this._url = url;
    }
    ModalFrame.prototype.create = function () {
        var iframe = document.createElement('IFRAME');
        iframe.src = this._url;
        return iframe;
    };
    return ModalFrame;
}());
